import React from "react";
                 import Equation from './Equation.jsx'
                 import ColorPicker from './ColorPicker.jsx'
                 import PopQuiz, {PopQuizItem} from './PopQuiz.jsx'
                 import ProofWalkthru from './ProofWalkthru.jsx'
                 import GradientDescentDemo from './GradientDescentDemo.jsx';
                 import FollowTheFold from './FollowTheFold.jsx';
                 import ContourExplorer from './ContourExplorer.jsx';
                 import Prologue from './Prologue.jsx';
                 import MatrixMultiplication from './MatrixMultiplication.jsx';
                 
                const Chapter2 = ({bullet, color1, color2, color3}) => {
                    return (
                        <div>
                        <div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Prologue title="gradient descent-driven machine learning" image="/images/guessyourage.png" intro1="Many people study deep learning in the hopes of making some money from it. Nothing terribly wrong with that, but deep learning can sometimes be a stressful pursuit. In the spirit of due diligence, let's explore an alternative but equally viable career path. Let's become carnies." intro2="Carny is slang for carnival worker, a career path often associated with roving wagons of the late nineteenth and early twentieth centuries. Carnies would set up booths to test your strength, your dexterity, your prowess with a BB gun. While less common nowadays, there still exist great neoned spaces of funnel cakes and cotton candy machines and different ways you can pay to go in circles, where everything is totally easy until you try it, and where questions like &quot;why would I want my name on a grain of rice&quot; lose their relevance in the intoxicating vapor of nacho cheese." intro3="One enduring carnival game challenges the passerby: «I WILL GUESS YOUR AGE OR YOU WIN A PRIZE!» This is the booth we'll try to manage." />
</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="astatisticalapproachtocarnyhood">a statistical approach to carnyhood</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">In the traditional version of this game, the carnival worker estimates age based on physical characteristics. We will take a slightly different approach and permit ourselves to ask a single question of our customers. In particular, we'll ask them: &quot;How many computer science (CS) courses have you taken?&quot; We arrived at this particular question because we have three friends (being computer scientists, many of our friends are also computer scientists) whose data suggested it was a reliable indicator of age.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/cs_friends.png" alt="our friends" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Looks pretty bulletproof! It seems like we can safely assume that a person's age is approximately a linear function of the number of CS courses they've taken. Let variable <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>x</mi></mrow></math> represent the number of CS courses taken, and let variable <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>y</mi></mrow></math> represent the person's age. We'll assume that there exists some real number <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> such that, for most people, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>y</mi><mo>&#x02248;</mo><mi>&#x003B8;</mi><mi>x</mi></mrow></math>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">What is this mystery multiplier <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>? We don't know, so we have to <span className="term">estimate</span> it. One reasonable estimate is the value that best explains our observations about our friends. In other words, we'd like:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>5</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>20</mn></mrow></math>, or alternatively: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x02248;</mo><mn>0</mn></mrow></math>.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>8</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>28</mn></mrow></math>, or alternatively: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x02248;</mo><mn>0</mn></mrow></math>.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>12</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>41</mn></mrow></math>, or alternatively: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x02248;</mo><mn>0</mn></mrow></math>.</div>
</li>
</ul>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We can capture all three conditions with a single statement: </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x02248;</mo><mn>0</mn></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Conveniently, the left-hand side of this statement is always non-negative, and it equals zero if and only if <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>5</mn><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>20</mn></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>8</mn><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>28</mn></mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>12</mn><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>41</mn></mrow></math>, i.e. <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> perfectly predicts our observations. This suggests a computational method for choosing a value for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> - find the value that minimizes the following function:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>1</mn></msub><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">But this isn't the only way to express our desire that <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>5</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>20</mn></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>8</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>28</mn></mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>12</mn><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>41</mn></mrow></math>. These conditions are also captured by the statement:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x02248;</mo><mn>0</mn></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Again the left-hand side of this statement is always non-negative, and equals zero if and only if <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> perfectly predicts our observations. So an alternative method of choosing <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> is to find the value that minimizes:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Functions like <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>1</mn></msub><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> go by many names. Often they are called <span className="term">objective functions</span>, because our training objective is to find its minimal value. Another common name is <span className="term">loss functions</span>, because they quantitatively capture the loss of face we experience when we use a particular value for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>. For instance, suppose we decide that <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>10</mn></mrow></math>. If so, then we predict that Alice's age is 50, Bob's age is 80, and Chandra's age is 120. This incurs a loss (according to function <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>1</mn></msub></mrow></math>) of</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x000B7;</mi><mn>10</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x000B7;</mi><mn>10</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x000B7;</mi><mn>10</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0003D;</mo><mn>161</mn></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">which corresponds to 161 units of acute embarrassment. Contrast this with the choice of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>3</mn></mrow></math>, which incurs only 14 units of loss:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x000B7;</mi><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x000B7;</mi><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x000B7;</mi><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow><mo>&#x0003D;</mo><mn>14</mn></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Our goal is to find a value of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> that minimizes our loss. As an exercise, let's do so for loss function <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow></math>. We can use standard calculus techniques. First, take the first derivative of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow></math>:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">by the definition of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mn>20</mn><mo>&#x02212;</mo><mn>5</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mn>28</mn><mo>&#x02212;</mo><mn>8</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mn>41</mn><mo>&#x02212;</mo><mn>12</mn><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">sum rule of derivatives</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="false">&#x00028;</mo><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">5</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mn className="proof-highlight" mathvariant="bold">20</mn><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">5</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="false">&#x00028;</mo><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">8</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mn className="proof-highlight" mathvariant="bold">28</mn><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">8</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="false">&#x00028;</mo><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">12</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mn className="proof-highlight" mathvariant="bold">41</mn><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">12</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">because <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>a</mi><mo>&#x0002B;</mo><mi>b</mi><mi>&#x003B8;</mi><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mn>2</mn><mi>b</mi><mo stretchy="false">&#x00028;</mo><mi>a</mi><mo>&#x0002B;</mo><mi>b</mi><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mn className="proof-highlight" mathvariant="bold">466</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">1632</mn></mrow></mrow></math></div>
 <div className="justification">simplifying</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Now set it equal to zero and solve for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>: </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="⇒"><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mn>0</mn></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mn className="proof-highlight" mathvariant="bold">466</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo className="proof-highlight" mathvariant="bold">&#x02212;</mo><mn className="proof-highlight" mathvariant="bold">1632</mn></mrow><mo>&#x0003D;</mo><mn>0</mn></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>466</mn><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mrow><mn className="proof-highlight" mathvariant="bold">1632</mn></mrow></mrow></math></div>
 <div className="justification">add 1632 to both sides of the equation</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mfrac><mrow><mn>1632</mn></mrow><mrow><mrow><mn className="proof-highlight" mathvariant="bold">466</mn></mrow></mrow></mfrac></mrow></math></div>
 <div className="justification">divide both sides by 466</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x02248;</mo><mrow><mn className="proof-highlight" mathvariant="bold">3.5</mn></mrow></mrow></math></div>
 <div className="justification">approximating</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">A value of approximately <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mn>3.5</mn></mrow></math> minimizes our <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow></math> loss.</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="astatisticalapproachtocarnyhoodepilogue">a statistical approach to carnyhood (epilogue)</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With our statistically justified estimate of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x02248;</mo><mn>3.5</mn></mrow></math>, we take our show on the road. Unfortunately, most carnival attendees have never taken a computer science course before (i.e. <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>x</mi><mo>&#x0003D;</mo><mn>0</mn></mrow></math>), and so we guess that almost everybody is zero years old (as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>x</mi><mo>&#x0003D;</mo><mn>0</mn></mrow></math>).</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/zero_years_old.png" alt="guessing that everyone is zero years old" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We quickly go out of business.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">(Take this as a cautionary tale. Often we <span className="term">wrongly</span> assume that our &quot;training data&quot; — the observations that we use to estimate our parameters — follows the <span className="term">same</span> distribution as our evaluation data.)</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">While we didn't make money from it, our short-lived carny career did highlight several important elements of machine learning:</div>
<ol>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We collected <span className="term">training data</span>: the observations about our friends Alice, Bob, and Chandra.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We identified a space of <span className="term">models</span> for making predictions: the space of all functions of the form <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>y</mi><mo>&#x0003D;</mo><mi>&#x003B8;</mi><mi>x</mi></mrow></math>. The models were <span className="term">parameterized</span>, i.e. one could identify a particular model by specifying its <span className="term">parameter</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We developed a <span className="term">loss function</span> over parameters that assigned a non-negative real loss to every model in the model space.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We performed an <span className="term">optimization algorithm</span> (we took the first derivative of the loss function, set it equal to zero, and solved for parameter <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>) to find a model with minimal loss. </div>
</li>
</ol>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="morechallenginglossfunctions">more challenging loss functions</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">For the rest of the module, our focus will be on the <span className="term">optimization algorithm</span>: the procedure for finding a model with minimal loss. This was easy enough with the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow></math> loss function. We just took the first derivative, set it equal to zero, and solved for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>. But often the loss function is more complicated. What if it looked like this?</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>3</mn></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Let's try the same optimization algorithm. The first derivative is doable:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>l</mi><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">the sum rule of derivatives</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>3</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math> = 0</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">log</mi><mspace width="0.222em" /><msup><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msup><mo stretchy="false">&#x00029;</mo><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">sin</mi><mspace width="0.222em" /><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo className="proof-highlight" mathvariant="bold">&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">sin</mi><mspace width="0.222em" /><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">log</mi><mspace width="0.222em" /><msup><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></mrow></math></div>
 <div className="justification">the product rule of derivatives</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">cos</mi><mspace width="0.222em" /><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>cos</mi><mspace width="0.222em" /><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>cos</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>a</mi><mi>x</mi><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mi>a</mi></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>cos</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>2</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mrow><mfrac><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msup><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow><mrow><msup><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msup></mrow></mfrac></mrow></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mfrac><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow><mrow><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo></mrow></mfrac></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mi>log</mi><mspace width="0.222em" /><msup><mi>&#x003B8;</mi><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>cos</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>2</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>sin</mi><mspace width="0.222em" /><mn>2</mn><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mi>&#x000B7;</mi><mfrac><mrow><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></mrow></mrow><mrow><msup><mi>&#x003B8;</mi><mn>2</mn></msup></mrow></mfrac></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msup><mi>x</mi><mi>a</mi></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mi>a</mi><msup><mi>x</mi><mrow><mi>a</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msup></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">log</mi><mspace width="0.222em" /><msup><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">cos</mi><mspace width="0.222em" /><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo className="proof-highlight" mathvariant="bold">&#x0002B;</mo><mfrac><mrow><mn className="proof-highlight" mathvariant="bold">2</mn><mo stretchy="false">&#x00028;</mo><mi className="proof-highlight" mathvariant="bold">sin</mi><mspace width="0.222em" /><mn className="proof-highlight" mathvariant="bold">2</mn><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow><mrow><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi></mrow></mfrac></mrow></mrow></math></div>
 <div className="justification">simplifying</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Now we have to set it equal to zero and solve for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>. Go ahead! And good luck!</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Actually, you may not want to bother trying. If we graph the loss function, it looks like this:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/hardtooptimize.png" alt="a hard to optimize loss function" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">There are many <span className="term">local minima</span>, and it appears that there isn't a <span className="term">global minimum</span>, since the minima seem to just keep getting better as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> approaches (positive or negative) infinity. So there's really no hope of finding a value of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> that minimizes the loss. It doesn't exist.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">But maybe we don't need to insist on finding the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> that gives us the <span className="term">smallest possible</span> loss. Perhaps we can settle for a <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> that gives a <span className="term">small enough</span> loss. After all, in the &quot;guess your age&quot; booth, we don't always have to be perfect, we just don't want to embarrass ourselves. For the above loss function, the loss at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>7</mn></mrow></math> is somewhat better than at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>4</mn></mrow></math>, but the loss at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>4</mn></mrow></math> might still be acceptably small.</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="basicgradientdescent">basic gradient descent</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With our expectations lowered, let's develop an optimization algorithm that finds <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> with an &quot;acceptably small&quot; loss. First, forget the notion that we can somehow graph the loss function as we did above -- where we're going, there are no maps. We're in a hovercraft with nothing but an altimeter (the ability to compute our loss function for any given <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>) and short-range sensors (the ability to compute the first derivative of our loss function for any <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>).</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/initial_landing.png" alt="initial landing" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We make an initial landing at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>5</mn></mrow></math>. The planet (i.e. the undulating surface of our loss function) is frigidly cold, but it gets warmer in its lower altitudes. Hopefully we can find a valley deep enough and warm enough for shelter. Our short range sensors (i.e. the first derivative of the loss function) indicate that the slope of the ground at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>5</mn></mrow></math> is negative. In other words, we can decrease our altitude if we increase <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/sensors.png" alt="negative slope" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Sadly, this is an enemy planet. To avoid detection, we must travel above the clouds. That means we have to blindly guess how far to go before we re-land. If we're too conservative and increase <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> only by a smidgen, then we'll waste fuel, re-landing again and again until finally locating the base of the valley. If we're too reckless and increase <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> too much, we may skip over the valley entirely.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/reckless.png" alt="conservative vs reckless" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">The first mate has a proposal. So far we've only used the sign of the derivative. Because the derivative was negative at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>5</mn></mrow></math>, we knew we wanted to increase <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>. Can we somehow leverage the magnitude of the derivative to guide how far we go before re-landing?</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/gd_intuition.png" alt="large vs small slopes" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Consider when the derivative has a small magnitude. This can happen when the loss function is flattening, which happens near local minima. Conversely, when the derivative has a large magnitude, the slope is steep and possibly suggests we're not yet close to the base of the valley. This gives us a heuristic for how far to fly before relanding:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">If the magnitude of the derivative <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is <span className="term">small</span> at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>, then <span className="term">increase</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> by a <span className="term">small</span> amount.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">If the magnitude of the derivative <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is <span className="term">large</span> at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>, then <span className="term">increase</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> by a <span className="term">large</span> amount.</div>
</li>
</ul>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">In other words, <span className="term">increase</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> by an amount proportional to the magnitude of the derivative at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x02190;</mo><mi>&#x003B8;</mi><mo>&#x0002B;</mo><mi>&#x003B1;</mi><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">where <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi></mrow></math> is a positive real number we'll refer to as the <span className="term">learning rate</span>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Great! We have a strategy for when the derivative is negative. When the derivative is positive, we can adopt a similar strategy, but now we want to move in the opposite direction.  In other words, <span className="term">decrease</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> by an amount proportional to the magnitude of the derivative:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x02190;</mo><mi>&#x003B8;</mi><mo>&#x02212;</mo><mi>&#x003B1;</mi><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">To summarize:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">if <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is <span className="term">negative</span>, then <span className="term">add</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math> <span className="term">to</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math></div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">if <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is <span className="term">positive</span>, then <span className="term">subtract</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math> <span className="term">from</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math></div>
</li>
</ul>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Either way, it's actually the same thing: simply <span className="term">subtract</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> <span className="term">from</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Our optimization algorithm is therefore:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">start at an arbitrary <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math></div>
</li>
<li>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">keep &quot;landing&quot; at a new <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>, i.e. evaluate the derivative <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math> at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> and update <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x02190;</mo><mi>&#x003B8;</mi><mo>&#x02212;</mo><mi>&#x003B1;</mi><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math></Equation>
</div>
</li>
</ul>
</li>
</ul>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Algorithms like this, where we use the first derivative to guide our optimization, are known as <span className="term">gradient descent</span> algorithms. Experiment with how gradient descent behaves using the following interactive demo:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><GradientDescentDemo variant="vanilla" textColor={color1} areaColor={color2} highlightColor={color3}/>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Try some different learning rates and starting positions! Here are some phenomena you might observe:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With a sufficiently low learning rate (e.g. 0.10), starting in either valley means that you ultimately arrive at the base of that valley. This is not necessarily a good thing or a bad thing. It's nice that the procedure converges to some minimum, but we can potentially miss a deeper valley when the learning rate is too small.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With a learning rate of 0.20, the hovercraft typically doesn't converge to the deepest point of the rightmost valley, but rather bounces erratically around it.</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">A learning rate of 0.30 can cause very erratic behavior, and the hovercraft might end up flying off towards infinity (depending on the initial position).</div>
</li>
</ul>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="settingagoodlearningrate">setting a good learning rate</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">As the above demo suggests, one of the trickiest issues with gradient descent is the <span className="term">learning rate</span>. If learning rate <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi></mrow></math> is too small, then the optimization algorithm can take a very long time to reach a local minimum, because each position update is overly conservative. If <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi></mrow></math> is too large, then the optimization algorithm may keep jumping past the nearest local minimum.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/learningrates.png" alt="learning rate pitfalls" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Unfortunately, there isn't a single fixed learning rate that works well for all loss functions. Fortunately, we don't necessarily need to adopt a single fixed learning rate. As we proceed with gradient descent, we could <span className="term">adapt</span> the learning rate. One common strategy is to start with an aggressive (i.e. high) learning rate, and gradually become more conservative (i.e. lower the learning rate) as the algorithm continues. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/adagrad.png" alt="intuition behind adagrad" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We don't know anything about the landscape at first, so it benefits us to survey a few different landing sites and get a sense of the more promising (i.e. deeper) areas. Once we locate a promising valley, we no longer want to jump around erratically. We want to remain in the valley and carefully find its lowest point.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">To mathematically implement this strategy, we maintain a tally of the slopes <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><mi>&#x003B8;</mi></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mi>t</mi><mo stretchy="false">&#x00029;</mo></mrow></msup><mo stretchy="false">&#x00029;</mo></mrow></math> we land upon. Steeper slopes (more promising areas of exploration) have a larger magnitude, and therefore increase the tally more significantly. Since we care only about the magnitudes, our tally will be the sum of the squared derivatives:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>0</mn></mrow><mi>t</mi></msubsup><msup><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><mi>&#x003B8;</mi></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mi>i</mi><mo stretchy="false">&#x00029;</mo></mrow></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mn>2</mn></msup></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">To counterbalance the effects of the squaring, we use the square root of the tally as our &quot;odometer&quot; of how much we've explored so far:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msqrt><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>0</mn></mrow><mi>t</mi></msubsup><msup><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><mi>&#x003B8;</mi></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mi>i</mi><mo stretchy="false">&#x00029;</mo></mrow></msup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We divide the original learning rate by our &quot;exploration odometer&quot; to set an increasingly conservative learning rate for each subsequent time step, adding in a positive constant <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B4;</mi></mrow></math> to avoid division by zero. This optimization algorithm is called <span className="term">adagrad</span>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/adagradcode.png" alt="adagrad pseudocode" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Experiment with <span className="term">adagrad</span> using the following interactive demo:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><GradientDescentDemo variant="adagrad" textColor={color1} areaColor={color2} highlightColor={color3}/>
</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="goingwiththeflow">going with the flow</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Gradient descent is not unlike the classic game of &quot;I'm thinking of a number between 1 and 100,&quot; except that this game is a more frustrating version: &quot;I'm thinking of a number.&quot; Imagine you were playing this game. You start by guessing 10. Your opponent says &quot;higher&quot;. Then you guess 20. Your opponent says &quot;higher&quot;. Then you guess 30. Your opponent says &quot;higher&quot;. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Eventually you will likely get impatient with this. There's no upper bound, and your opponent keeps saying &quot;higher&quot;. You'd probably start skipping ahead by larger and larger intervals (100, 1000, 1000000, etc.) until your opponent finally said &quot;lower&quot;, giving you an upper bound, and perhaps a sense of peace.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We can implement the same strategy for gradient descent. If the slope repeatedly tells us to keep heading in the same direction, why not start accelerating, like a rolling stone? There's a variant of gradient descent, called <span className="term">momentum</span>, that updates our position not just based on the derivative, but also based on the size of our previous step. Suppose the loss function is:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x0007C;</mo><mn>0.2</mn><mi>&#x003B8;</mi><mo stretchy="true" fence="true" form="postfix">&#x0007C;</mo></mrow></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Using the basic gradient descent algorithm (with a fixed learning rate <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mo>&#x0003D;</mo><mn>0.5</mn></mrow></math>, and initial position <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mn>0</mn><mo stretchy="false">&#x00029;</mo></mrow></msup><mo>&#x0003D;</mo><mn>2.0</mn></mrow></math>), here are the first five position updates: </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/nomomentum.png" alt="demonstration of no momentum" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Since the slope is <span className="term">constant</span>, we always make the same update, reducing our position by 0.1.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">To simulate &quot;momentum&quot;, we update our position not just based on the current <span className="term">slope</span>, but also by adding in our <span className="term">previous update</span>. This creates a snowball effect, with increasingly aggressive updates, as long as we keep heading in the same direction. To control the relative impact of momentum, we include a <span className="term">momentum rate</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003BC;</mi></mrow></math> as a multiplier. In this example, we use momentum rate <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003BC;</mi><mo>&#x0003D;</mo><mn>1.0</mn></mrow></math>:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/momentumsteps.png" alt="demonstration of momentum" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Here is the pseudocode for gradient descent with momentum: </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/momentum_pseudocode.png" alt="momentum pseudocode" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Experiment with <span className="term">momentum</span> using the following interactive demo:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><GradientDescentDemo variant="momentum" textColor={color1} areaColor={color2} highlightColor={color3}/>
</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="othervariantsofgradientdescent">other variants of gradient descent</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">There are many other variants of gradient descent that follow the general template. For instance, instead of using the sum of squared derivatives as our &quot;exploration odometer&quot; (i.e. <span className="term">adagrad</span>), a technique called <span className="term">rmsprop</span> uses a decaying average of the squared derivatives. A decaying average gives more weight to the recent derivatives, allowing the algorithm to gradually forget the past and become aggressive again if it enters a phase during which it makes little vertical progress.  </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">It is also perfectly possible to mix-and-match strategies. A popular technique called <span className="term">adam</span> can be roughly described as <span className="term">rmsprop</span> with <span className="term">momentum</span>, i.e. it uses the <span className="term">SetLearningRate</span> subroutine of rmsprop in concert with the <span className="term">UpdatePosition</span> subroutine of momentum.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">One might wonder: why so many variants? which one should I use? As yet, there appears to be no single technique that consistently outperforms the rest. As Goodfellow, Bengio, and Courville put it in their book: &quot;The choice of which algorithm to use, at this point, seems to depend largely on the user's familiarity with the algorithm.&quot;</div>
<div className="dlamp-section-spacer" /><hr></hr><h4 className="dlamp-header1" id="multivariablegradientdescent">multivariable gradient descent</h4>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">So far, we have only considered loss functions of a single variable <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math>, but usually loss functions involve more than one variable. After the spectacular failure of our first <span className="term">GUESS YOUR AGE</span> booth, we retool and relaunch, like a phoenix from the ashes. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">This time we collect different information from our friends. Using their photos, we analyze their hair colors with a color meter that measures <span className="term">saturation</span> and <span className="term">lightness</span>. Both are measured on a real scale from 0 to 1. Higher saturation corresponds to more intense color. As we vary lightness from 0 to 1, the color goes from very dark to very light:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ColorPicker />
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We notice that our older friends' hair has lower saturation and higher lightness. Based on this, we formulate a new strategy for our booth. Rather than asking customers how many CS classes they've taken, we'll wear a special set of glasses that measures the saturation and lightness of their hair. Based on these numbers, we'll predict their age using the formula: </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">where the variables <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></math> represent the <span className="term">saturation</span> and <span className="term">lightness</span> of their hair color, and the variables <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> are <span className="term">parameters</span> that we'll <span className="term">estimate</span> based on the following observations we've made about our friends:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/friendshair.png" alt="saturation and lightness data" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Just like before, we want to find parameter values that do a good job of predicting our friends' ages. We will refer to the values we find as <span className="term">parameter estimates</span>. In this case, we want to find parameter estimates <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub></mrow></math> that:</div>
<ul>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">approximately predict Alice's age: <Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>.72</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02248;</mo><mn>20</mn></mrow></math></Equation>
</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">approximately predict Bob's age: <Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>.34</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02248;</mo><mn>28</mn></mrow></math></Equation>
</div>
</li>
<li><div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">approximately predict Chandra's age: <Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>.17</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02248;</mo><mn>41</mn></mrow></math></Equation>
</div>
</li>
</ul>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">We can combine these three conditions into a single objective. We want:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">to be as close to zero as possible. Observe that this expression is always non-negative, and when it equals zero, the parameters predict our friends' ages perfectly. So we'll make it our loss function. Let:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002C;</mo><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Previously, we used gradient descent to find a sufficiently small value of our loss function, but that was for a loss function of one variable. Now we have a loss function of two variables. How can gradient descent be adapted? Rather than using variable <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> to refer to a single parameter, we will now use it to refer to a <span className="term">vector</span> of parameters. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Our loss function <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi></mrow></math> assigns a non-negative loss to each 2-dimensional vector <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math>. We can use a <span className="term">contour plot</span> to visualize the loss function:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ContourExplorer />
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Each curve of the plot connects values of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> for which loss <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is equivalent. The plot also uses shading to indicate the magnitude of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math>: darker shades of red indicate larger values of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math>, which means that the pale oval at the center is a valley.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">The above contour plot is interactive. Try clicking on different points on the innermost curve. They should all have the same loss, but it's difficult to click exactly on the curve, so you'll probably see losses between 1900 and 2000 (unless you're bad at clicking). If you click close to the bottom of the valley, then you should get a loss that is reasonably close to zero (I can get a loss of less than 15 if I keep clicking). Note that there is no point that has a loss of zero, because technically there is no value of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B8;</mi></mrow></math> that perfectly predicts our data.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">For multivariable gradient descent, we execute single-variable gradient descent in parallel for each variable, while pretending the other variables don't exist. Or, more accurately, we pretend that the other variables have already been set to their ideal values, so the only thing left to do is optimize the remaining variable. In our example then, we need to compute two derivatives: one where we treat <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> as a constant and differentiate with respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math>, and one where we treat <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> as a constant and differentiate with respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math>. In other words, we need to compute the <span className="term">partial derivatives</span> <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math>. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">sum rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><msup><mo stretchy="false">&#x00029;</mo><mi>a</mi></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mi>a</mi><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><msup><mo stretchy="false">&#x00029;</mo><mrow><mi>a</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msup><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00029;</mo></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">1</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">sum rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">constant rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.72</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.34</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.17</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">power rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>1.33</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.45</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>61.8</mn></mrow></math></div>
 <div className="justification">approximating</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo>&#x0002B;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><msup><mo stretchy="false">&#x00029;</mo><mn>2</mn></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">sum rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">because: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><msup><mo stretchy="false">&#x00029;</mo><mi>a</mi></msup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><mo>&#x0003D;</mo><mi>a</mi><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><msup><mo stretchy="false">&#x00029;</mo><mrow><mi>a</mi><mo>&#x02212;</mo><mn>1</mn></mrow></msup><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00029;</mo></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><msub><mi className="proof-highlight" mathvariant="bold">D</mi><mrow><msub><mi className="proof-highlight" mathvariant="bold">&#x003B8;</mi><mn className="proof-highlight" mathvariant="bold">2</mn></msub></mrow></msub></mrow><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">sum rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mn className="proof-highlight" mathvariant="bold">0</mn></mrow><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">constant rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd /><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.72</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.06</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>20</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.06</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.34</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.25</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>28</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.25</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x0002B;</mo></mtd><mtd><mn>2</mn><mo stretchy="false">&#x00028;</mo><mi>.17</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.57</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>41</mn><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mrow><mi className="proof-highlight" mathvariant="bold">.57</mi></mrow><mo stretchy="false">&#x00029;</mo></mtd></mtr></mtable></mrow></math></div>
 <div className="justification">power rule</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>.45</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.78</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>63.1</mn></mrow></math></div>
 <div className="justification">approximating</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With the partial derivatives computed, we're ready to execute gradient descent in parallel for parameters <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math>. Suppose our initial position is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x00028;</mo><mtable><mtr><mtd><mo>&#x02212;</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math> and our learning rate is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mo>&#x0003D;</mo><mi>.05</mi></mrow></math>.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Initially, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>4</mn></mrow></math>. Our updated <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> is:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x02212;</mo><mi>&#x003B1;</mi><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x02212;</mo><mi>&#x003B1;</mi><mo stretchy="false">&#x00028;</mo><mn>1.33</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.45</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>61.8</mn><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x02212;</mo><mn>4</mn><mo>&#x02212;</mo><mi>.05</mi><mo stretchy="false">&#x00028;</mo><mn>1.33</mn><mo stretchy="false">&#x00028;</mo><mo>&#x02212;</mo><mn>4</mn><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mi>.45</mi><mo stretchy="false">&#x00028;</mo><mn>2</mn><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mn>61.8</mn><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">because <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>4</mn></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0003D;</mo><mn>2</mn></mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mo>&#x0003D;</mo><mi>.05</mi></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x02212;</mo><mn>0.689</mn></mrow></math></div>
 <div className="justification">simplifying</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Initially, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0003D;</mo><mn>2</mn></mrow></math>. Our updated <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> is:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><ProofWalkthru marker="="><div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mi>&#x003B1;</mi><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mi>&#x003B8;</mi><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mi>&#x003B1;</mi><mo stretchy="false">&#x00028;</mo><mi>.45</mi><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><mi>.78</mi><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x02212;</mo><mn>63.1</mn><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">...</div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>2</mn><mo>&#x02212;</mo><mi>.05</mi><mo stretchy="false">&#x00028;</mo><mi>.45</mi><mo stretchy="false">&#x00028;</mo><mo>&#x02212;</mo><mn>4</mn><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mi>.78</mi><mo stretchy="false">&#x00028;</mo><mn>2</mn><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mn>63.1</mn><mo stretchy="false">&#x00029;</mo></mrow></math></div>
 <div className="justification">because <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0003D;</mo><mo>&#x02212;</mo><mn>4</mn></mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0003D;</mo><mn>2</mn></mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>&#x003B1;</mi><mo>&#x0003D;</mo><mi>.05</mi></mrow></math></div></div>
 <div className="step"><div className="math"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>5.167</mn></mrow></math></div>
 <div className="justification">simplifying</div></div></ProofWalkthru>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Therefore, the next step of gradient descent moves from <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x00028;</mo><mtable><mtr><mtd><mo>&#x02212;</mo><mn>4</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x00028;</mo><mtable><mtr><mtd><mo>&#x02212;</mo><mn>0.689</mn></mtd></mtr><mtr><mtd><mn>5.167</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math>:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/twodims.jpg" alt="two dimensional gradient descent" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Notationally, it helps to introduce a function called the <span className="term">gradient</span> that simultaneously computes all the partial derivatives of a vector function, i.e. the gradient maps a vector function to a vector of all its partial derivatives. Let vector <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>x</mi><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>x</mi><mi>n</mi></msub></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math>. The <span className="term">gradient</span> of a vector function <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>f</mi><mo stretchy="false">&#x00028;</mo><mi>x</mi><mo stretchy="false">&#x00029;</mo></mrow></math> is defined:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">To evaluate every partial derivative at a particular value <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover></mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>x</mi></mrow></math>, we define the following notation:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mo stretchy="false">&#x00029;</mo></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow></msub><mo stretchy="false">&#x00028;</mo><mi>f</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mo stretchy="false">&#x00029;</mo></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><div className="dlamp-focus-container"><span className="dlamp-focus-title">example</span><br/><br/> Consider the following loss function: <div className="dlamp-paragraph-spacer" /><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>l</mi><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&#x003B8;</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>&#x00029;</mo><mo>&#x0003D;</mo><mn>5</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>1</mn></msub><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0002B;</mo><msubsup><mi>&#x003B8;</mi><mn>3</mn><mn>3</mn></msubsup></mrow></math></Equation><div className="dlamp-paragraph-spacer" />
 The gradient is: <div className="dlamp-paragraph-spacer" /><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo></mtd><mtd><mo>&#x0003D;</mo></mtd><mtd><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>5</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>1</mn></msub><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0002B;</mo><msubsup><mi>&#x003B8;</mi><mn>3</mn><mn>3</mn></msubsup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>5</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>1</mn></msub><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0002B;</mo><msubsup><mi>&#x003B8;</mi><mn>3</mn><mn>3</mn></msubsup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow><msub><mi>&#x003B8;</mi><mn>3</mn></msub></mrow></msub><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mn>5</mn><msub><mi>&#x003B8;</mi><mn>1</mn></msub><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>1</mn></msub><msub><mi>&#x003B8;</mi><mn>2</mn></msub><mo>&#x0002B;</mo><msubsup><mi>&#x003B8;</mi><mn>3</mn><mn>3</mn></msubsup><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow></mtd></mtr></mtable><mo>&#x00029;</mo><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><mn>5</mn><mo>&#x0002B;</mo><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mn>3</mn><msubsup><mi>&#x003B8;</mi><mn>3</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo>&#x00029;</mo></mtd></mtr></mtable></mrow></math></Equation><div className="dlamp-paragraph-spacer" />
 The value of the gradient at <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mn>3</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math> is: <div className="dlamp-paragraph-spacer" /><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtable><mtr><mtd><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><mover><mrow><mi>&#x003B8;</mi></mrow><mo stretchy="false">&#x0005E;</mo></mover><mo stretchy="false">&#x00029;</mo></mtd><mtd><mo>&#x0003D;</mo></mtd><mtd><mo>&#x00028;</mo><mtable><mtr><mtd><mn>5</mn><mo>&#x0002B;</mo><mn>2</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>3</mn><mo stretchy="false">&#x00028;</mo><msup><mn>3</mn><mn>2</mn></msup><mo stretchy="false">&#x00029;</mo></mtd></mtr></mtable><mo>&#x00029;</mo><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><mn>7</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>27</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mtd></mtr></mtable></mrow></math></Equation><div className="dlamp-paragraph-spacer" />
 </div>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Conveniently, we barely have to change our gradient descent code (and perhaps now it's clearer why we called it gradient descent). For basic gradient descent and gradient descent with momentum, we just have to recognize that some of the quantities are now <span className="term">vectors</span>, not <span className="term">scalars</span>. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/multidimensional_gd.jpg" alt="multidimensional gradient descent" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Experiment with multidimensional gradient descent using the following interactive demo:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><FollowTheFold />
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">By default, the demo starts the hovercraft at point <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x00028;</mo><mtable><mtr><mtd><mo>&#x02212;</mo><mn>1.6</mn></mtd></mtr><mtr><mtd><mn>0.55</mn></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math>, using a learning rate of 1.0 and no momentum. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Push the play button a few times to see what happens. Observe that the hovercraft keeps skipping over the valley in the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> direction, even as it makes progress along the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> axis. </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">However, momentum will act <span className="term">independently</span> for the two axes <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math>. Whereas the steps along the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> axis are always in the same direction (and therefore can accumulate momentum), the steps along the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> axis keep reversing direction (and therefore cancel each other out). </div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Reset the hovercraft to its original position (click directly on the contour plot to reposition the hovercraft). Now try a momentum rate of 0.5. You should observe both an acceleration along the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>1</mn></msub></mrow></math> axis, and a dampening effect along the <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>&#x003B8;</mi><mn>2</mn></msub></mrow></math> axis, as the fluctuating step direction gradually moderates the step size.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">For the multidimensional case, we need to slightly modify the code for adagrad:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><img className="dlamp-image" src="/images/multidimensional_adagrad.jpg" alt="multidimensional adagrad" /></div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">Instead of a single learning rate, there is now a learning rate vector that captures independently learning rates for each axis. This is necessary, because the slopes encountered along each axis are different. Along one axis, the slopes could be gentle (and therefore the adagrad &quot;odometer&quot; would grow slowly), whereas along another axis, the slopes could be steep (and therefore the odometer would grow quickly). We separately track the odometer for each axis.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">There are two notations in the above code that may be unfamiliar. The first is <span className="term">Hadamard product</span>, denoted using the symbol <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x02299;</mo></mrow></math>:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><div className="dlamp-focus-container"><span className="dlamp-focus-title">definition</span><br/><br/> The <span className="term">Hadamard product</span> of two length-<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>n</mi></mrow></math> vectors <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>w</mi></mrow></math> is the elementwise multiplication of the vectors, i.e. <Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi><mo>&#x02299;</mo><mi>w</mi><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>v</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>n</mi></msub></mtd></mtr></mtable><mo>&#x00029;</mo><mo>&#x02299;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>w</mi><mi>n</mi></msub></mtd></mtr></mtable><mo>&#x00029;</mo><mo>&#x0003D;</mo><mo>&#x00028;</mo><mtable><mtr><mtd><msub><mi>v</mi><mn>1</mn></msub><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>&#x022EE;</mo></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>n</mi></msub><msub><mi>w</mi><mi>n</mi></msub></mtd></mtr></mtable><mo>&#x00029;</mo></mrow></math></Equation>
 </div>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">In the above adagrad code, Hadamard product is used to show the multiplication of each learning rate with its corresponding derivative in the loss gradient.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">The other notation in the adagrad code that might need explanation is when we do the following division:</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor"><Equation><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi>&#x003B4;</mi><mo>&#x0002B;</mo><msqrt><mrow><msubsup><mo>&#x02211;</mo><mrow><mi>i</mi><mo>&#x0003D;</mo><mn>0</mn></mrow><mi>t</mi></msubsup><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mi>i</mi><mo stretchy="false">&#x00029;</mo></mrow></msup><mo stretchy="false">&#x00029;</mo><mo>&#x02299;</mo><msub><mi>D</mi><mi>&#x003B8;</mi></msub><mo stretchy="false">&#x00028;</mo><mi>l</mi><mo stretchy="false">&#x00029;</mo><mo stretchy="false">&#x00028;</mo><msup><mi>&#x003B8;</mi><mrow><mo stretchy="false">&#x00028;</mo><mi>i</mi><mo stretchy="false">&#x00029;</mo></mrow></msup><mo stretchy="false">&#x00029;</mo></mrow></msqrt></mrow></mfrac></mrow></math></Equation>
</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">In this case, the denominator is a vector, so it might be unclear what <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi>v</mi></mrow></mfrac></mrow></math> means when <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>v</mi></mrow></math> is a vector. We simply mean that we take the original vector, and replace all its elements with their reciprocals.</div>
<div className="dlamp-paragraph-spacer" /><div className="dlamp-text textcolor">With multidimensional gradient descent, we are now free to minimize loss functions with any (finite) number of parameters. In the future, we will be making the most of this freedom.</div>

                        </div>
                    );
                }
    

                export default Chapter2;
                
